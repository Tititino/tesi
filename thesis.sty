\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{thesis}

\RequirePackage{amsfonts}
\RequirePackage{amssymb}
\RequirePackage{amsmath}
\RequirePackage{amsthm}
\RequirePackage{geometry}
% \RequirePackage[english]{babel}
\RequirePackage{bussproofs}
\RequirePackage{cancel}
\RequirePackage{caption}
\RequirePackage{float}
\RequirePackage{epsfig}
% \RequirePackage{embedall}\embedfile{\jobname.tex}
\RequirePackage[bookmarks]{hyperref}
\RequirePackage{graphicx}
\RequirePackage{minted}
\RequirePackage{rotating}
\RequirePackage{setspace}
\RequirePackage{siunitx}
\RequirePackage{subcaption}
\RequirePackage{tabularray}
\RequirePackage[colorinlistoftodos]{todonotes}
% \RequirePackage{listings}
\RequirePackage{url}
\RequirePackage{xcolor}

\RequirePackage[utf8]{inputenc}

\DeclareOption{dbg}{\overfullrule=5pt}
\ProcessOptions\relax

\graphicspath{ {./figures/} }

\theoremstyle{plain}
\newtheorem{teor}{Theorem}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{fact}{Fact}[section]

\theoremstyle{definition}
\newtheorem{define}{Definition}[section]
\newenvironment{myteor}{\begin{teor}\sl}{\end{teor}}
\renewcommand\qedsymbol{$\blacksquare$}

\definecolor{codegray}{gray}{0.95}
% \lstdefinestyle{mystyle}{
%   % frame=lines,
%   numberstyle=\tiny\color{black},
%   basicstyle=\footnotesize,
%   % breakatwhitespace=false,
%   % breaklines=true,
%   % captionpos=b, keepspaces=true,
%   numbers=left,
%   numbersep=5pt,
%   % showspaces=false,
%   % showstringspaces=false,
%   % showtabs=false,
%   % tabsize=2
%   % sensitive=true
% }
% \lstset{style=mystyle}

\newcommand{\llpar}{\:\rotatebox[origin=c]{180}{\&}\:}
\newcommand{\llten}{\otimes}
\newcommand{\llwith}{\:\&\:}
\newcommand{\llplus}{\oplus}
\newcommand{\llbot}{\bot}
\newcommand{\lltop}{\top}
\newcommand{\llone}{1}
\newcommand{\llzero}{0}
\newcommand{\llnot}[1]{{#1}\!\,^{\llbot}}
\newcommand{\llwn}[1]{? #1}
\newcommand{\llbang}[1]{! #1}
\newcommand{\lolli}{\multimap}
\newcommand{\focus}[4][]{\; \vdash_{\text{#1}} #2 : #3 \Downarrow #4}
\newcommand{\async}[4][]{\; \vdash_{\text{#1}} #2 : #3 \Uparrow   #4} 
\newcommand{\used}[1]{#1 \; \mathrm{used}}
\newcommand{\separator}{\; \Vert \;}
\newcommand{\constr}[2]{#1 : #2}
\newcommand{\avail}[1]{#1 \; \mathrm{avail}}
\newcommand{\isAsy}[1]{#1 \; \mathrm{asy}}
\newcommand{\isSync}[1]{#1 \; \mathrm{sync}}
\newcommand{\isNegLit}[1]{#1 \; \mathrm{atom}}
\newcommand{\new}[1]{#1 \; \mathrm{new}}
\newcommand{\isPosLit}[1]{#1 \; \mathrm{pos\;lit}}
\newcommand{\af}[2]{\langle #1, #2 \rangle}
\newcommand{\sat}[2]{#1\!\downarrow\!#2}
\newcommand{\var}[1]{x_{#1}}
\newcommand{\varNot}[1]{\overline{#1}}
\newcommand{\varAnd}{\wedge}
\newcommand{\CLPB}{CLP($\mathcal{B}$)}
\newcommand{\mathV}{\mathrm{V}}
\newcommand{\subst}{:=}
\newcommand{\vars}[1]{\mathrm{vars}(#1)}
\newcommand{\expr}[1]{\mathrm{expr}(#1)}
\newcommand{\Dom}[1]{\mathrm{Dom}(#1)}
\newcommand{\spliton}[2]{\mathrm{split}_{#2}(#1)}

\newcommand{\displayten}{\llten}
\newcommand{\displaypar}{\!\llpar\!}
\newcommand{\displaywith}{\!\llwith\!}
\newcommand{\displayplus}[1][]{{\llplus_{\mathrm{#1}}}}
\newcommand{\displaybang}{\;\llbang{}\;}
\newcommand{\displaywn}{\;\llwn{}\;}
\newcommand{\displaytop}{\lltop}
\newcommand{\displaybot}{\llbot}
\newcommand{\displaylolli}{\lolli}
\newcommand{\displayone}{\llone}
\newcommand{\displayzero}{\llzero}
\newcommand{\displaytoasy}{R\!\Downarrow}
\newcommand{\displaytodelta}{R\!\Uparrow}
\newcommand{\displayid}[1][]{{I_{\mathrm{#1}}}}
\newcommand{\displaydecide}[1][]{{D_{\mathrm{#1}}}}

\newcommand{\derRule}[2][]{$[{#2}]_{\mathrm{{#1}}}$}
\newcommand{\indCase}[1]{\item[$({#1})$]:}

\newcommand{\blankpage}{%
      \clearpage%
      \thispagestyle{empty}%
      \addtocounter{page}{-1}%
      \null%
      \clearpage}

% \newenvironment{ocaml}[1][none]
% 	{\begin{lstlisting}[language=caml]
% 	}
% 	{
% 	\\
% 	\end{lstlisting}
% 	}
% \newenvironment{prolog}[1][none]
% 	{\begin{lstlisting}[language=prolog]
% 	}
% 	{
% 	\\
% 	\end{lstlisting}
% 	}

\usemintedstyle{bw}

\EnableBpAbbreviations

\oddsidemargin 0.5in \evensidemargin 0in
\marginparwidth 40pt \marginparsep 10pt
\topmargin 0pt \headsep .5in
\textheight 8.1in \textwidth 6in

\brokenpenalty=10000

\renewcommand{\baselinestretch}{1.0}

\def\cl@chapter{\@elt{section}\@elt{footnote}}
\def\thefigure{\@arabic\c@figure}
\def\thetable{\@arabic\c@table}
\def\theequation{\arabic{equation}}

\newif\iffigurespage \newif\iftablespage
\figurespagefalse
\tablespagefalse

\def\frontespizio{
	\pagenumbering{gobble}
	\begin{center}
		{\LARGE \uppercase{Universit\`a degli Studi di Milano}}\\
		\uppercase{Facolt\`a di Scienze e Tecnologie}\\
		\vskip 0.4 cm
		\uppercase{Dipartimento di Informatica\\{``Giovanni Degli Antoni''}}\\
		\vskip 0.6 cm
		\centerline{\includegraphics[height=30mm]{unimi}}
		\vskip 0.4 cm
		\uppercase{\myCDL}
	\end{center}
	
	\vfill
	\vskip 1.5 cm

    \begin{spacing}{1.5}
	   \begin{center}
        {\Huge\uppercase\expandafter{\myTitle}}
	   \end{center}
    \end{spacing}
	
	\vfill
	\vskip 1.5 cm
	
	\begin{tabular}{ll}
		{\large Relatore:} & \myRefereeA\\
		\@ifundefined{myRefereeB}{}{{\large Correlatore:} & \myRefereeB\\}
		\@ifundefined{myRefereeC}{}{{\large Correlatore:} & \myRefereeC\\}
	\end{tabular}
	
	\vfill
	\vskip 1 cm
	
	\begin{tabular}{r}
		\hspace{9cm}{\large Tesi di Laurea di}\\
		\hspace{9cm}{\large \myName}\\
		\hspace{9cm}{\large \myMat}\\
	\end{tabular}
	
	\vfill
	\vskip 2.5 cm
	
	\begin{center}
		\sc anno accademico \myYY
	\end{center}\vskip.5in
	\newpage
}

\def\beforepreface{
	\pagenumbering{roman}
	\pagestyle{plain}}

\def\prefacesection#1{%
	\chapter*{#1}
	\addcontentsline{toc}{chapter}{#1}}

\def\afterpreface{\newpage
	\addcontentsline{toc}{chapter}{Index}
	\tableofcontents
	\newpage
	\iftablespage
	{\addvspace{10pt}
		\let\saveaddvspace=\addvspace
		\def\addvspace##1{}
		\addcontentsline{toc}{chapter}{Elenco delle tabelle}
		\listoftables
		\let\addvspace=\saveaddvspace}
	\newpage
	\fi
	\iffigurespage
	{\addvspace{10pt}
		\let\saveaddvspace=\addvspace
		\def\addvspace##1{}
		\addcontentsline{toc}{chapter}{Elenco delle figure}
		\listoffigures
		\let\addvspace=\saveaddvspace}
	\newpage
	\fi
	\pagenumbering{arabic}
	\pagestyle{headings}}

\pagestyle{headings}
